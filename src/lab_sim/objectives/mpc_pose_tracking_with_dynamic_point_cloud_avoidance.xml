<?xml version='1.0' encoding='UTF-8'?>
<root BTCPP_format="4" main_tree_to_execute="MPC Pose Tracking With Dynamic Point Cloud Avoidance">
  <BehaviorTree ID="MPC Pose Tracking With Dynamic Point Cloud Avoidance" _description="" _favorite="false">
    <Control ID="Sequence" name="TopLevelSequence">
      <SubTree ID="Clear Snapshot" _collapsed="true"/>
      <SubTree ID="_Scan Scene" _collapsed="true"/>
      <Action ID="GetPoseFromUser" is_normal="true" pose_prompt="Click point on UI" user_pose="{user_pose}" view_name="Visualization"/>
      <Action ID="GetPointCloud" message_out="{point_cloud}" timeout_sec="5.000000" topic_name="/scene_camera/points" publisher_timeout_sec="5.000000"/>
      <Action ID="GetCentroidFromPointCloud" output_pose="{output_pose}" point_cloud="{point_cloud}"/>
      <Action ID="CropPointsInBox" crop_box_centroid_pose="{output_pose}" point_cloud="{point_cloud}" point_cloud_cropped="{point_cloud}" crop_box_size="2.0; 2.0; 2.0"/>
      <SubTree ID="Clear Snapshot" _collapsed="true"/>
      <Action ID="SendPointCloudToUI" pcd_topic="/pcd_pointcloud_captures" point_cloud="{point_cloud}"/>
      <Action ID="CreateStampedPose" reference_frame="grasp_link" stamped_pose="{gripper_pose}" position_xyz="0;0;0"/>
      <Action ID="TransformPoseFrame" input_pose="{gripper_pose}" output_pose="{gripper_pose}" target_frame_id="world"/>
      <Action ID="VisualizePose" marker_lifetime="0.000000" marker_name="gripper_pose" marker_size="0.100000" pose="{gripper_pose}"/>
      <Action ID="CreateCollisionSpheresAtClosestPoints" closest_point_count="10" collision_object="{collision_object}" filter_cylinder_height="1.0" filter_cylinder_radius="1.0" point_cloud="{point_cloud}" reference_pose="{gripper_pose}" sphere_radius="0.25"/>
      <SubTree ID="ComputePoseStampedFromWaypoint" _collapsed="false"/>
      <Action ID="TransformPoseFrame" input_pose="{user_pose}" target_frame_id="world" output_pose="{stamped_pose}"/>
      <Action ID="VisualizePose" marker_lifetime="0.000000" marker_name="target_pose" marker_size="0.100000" pose="{stamped_pose}"/>
      <Action ID="CreateStampedTwist" reference_frame="world" stamped_twist="{stamped_twist}"/>
      <Control ID="Fallback">
        <Decorator ID="Timeout" msec="10000">
          <Control ID="Sequence">
            <Action ID="MPCSphereClearance" differentiable="0" follow_joint_trajectory_topic="/joint_trajectory_controller/follow_joint_trajectory" gradient_num_trajectory="32" gradient_spline_points="1.000000" horizon="0.1" planning_group="manipulator" sampling_control_width="0.015000" sampling_exploration="0.050000" sampling_sample_width="0.010000" sampling_spline_points="10.000000" set_ctrl_command_to_current_state="true" timestep="0.010000" total_return="{total_return}" cartesian_acceleration="100" cartesian_acceleration_body="tool_changer" cartesian_velocity="100" cartesian_velocity_body="tool_changer" collision_sphere_object="{collision_object}" gripper_site_name="pinch" link_sites="base_site" max_cartesian_acceleration_goal="500" max_cartesian_velocity_goal="0.5" mujoco_model="description/simple_scene.xml" mujoco_model_package="lab_sim" safe_distance="0.25" sphere_clearance="1.0" site_tracking="1.0" target_pose="{stamped_pose}" target_twist="{stamped_twist}" warmup_iterations="256" timeout="300"/>
          </Control>
        </Decorator>
        <Action ID="AlwaysSuccess"/>
      </Control>
    </Control>
  </BehaviorTree>
  <TreeNodesModel>
    <SubTree ID="MPC Pose Tracking With Dynamic Point Cloud Avoidance"/>
  </TreeNodesModel>
</root>
