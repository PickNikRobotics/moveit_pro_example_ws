<!-- Define your scale factor here -->
<!-- SCALE = 1.0 for full size, 0.5 for half size, etc. -->
<mujoco model="fr3 scene">
  <!-- Robot -->
  <include file="franka3.xml" />

  <!-- Assets -->
  <include file="assets/kitchen_assets/item_assets/oven_asset.xml" />
  <include file="assets/kitchen_assets/item_assets/counters_asset.xml" />
  <include file="assets/kitchen_assets/item_assets/backwall_asset.xml" />
  <include file="assets/kitchen_assets/item_assets/slidecabinet_asset.xml" />
  <include file="assets/kitchen_assets/item_assets/hingecabinet_asset.xml" />
  <include file="assets/kitchen_assets/item_assets/microwave_asset.xml" />
  <include file="assets/kitchen_assets/item_assets/kettle_asset.xml" />

  <visual>
    <headlight diffuse="0.6 0.6 0.6" ambient="0.3 0.3 0.3" specular="0 0 0" />
    <rgba haze="0.15 0.25 0.35 1" />
    <global azimuth="120" elevation="-20" />
  </visual>

  <asset>
    <texture
      type="skybox"
      builtin="gradient"
      rgb1="0.3 0.5 0.7"
      rgb2="0 0 0"
      width="512"
      height="3072"
    />
    <texture
      type="2d"
      name="groundplane"
      builtin="checker"
      mark="edge"
      rgb1="0.2 0.3 0.4"
      rgb2="0.1 0.2 0.3"
      markrgb="0.8 0.8 0.8"
      width="300"
      height="300"
    />
    <material
      name="groundplane"
      texture="groundplane"
      texuniform="true"
      texrepeat="5 5"
      reflectance="0.2"
    />
  </asset>

  <worldbody>
    <light pos="0 0 0.9" dir="0 0 -1" directional="true" />
    <geom name="floor" size="0 0 0.03" type="plane" material="groundplane" />

    <!-- Scene Camera -->
    <site
      name="scene_camera_optical_frame"
      pos="-0.476 -0.378 2.733"
      xyaxes="0.510 -0.860 0.000 -0.666 -0.395 -0.633"
    />

    <camera
      name="scene_camera"
      fovy="48"
      resolution="640 480"
      pos="-0.476 -0.378 2.733"
      xyaxes="0.510 -0.860 0.000 0.666 0.395 0.633"
    />

    <!-- Back scene Camera -->
    <site
      name="back_camera_optical_frame"
      pos="-0.661 0.324 1.325"
      xyaxes="0.026 -1.000 0.000 -0.062 -0.002 -0.998"
    />

    <camera
      name="back_camera"
      fovy="48"
      resolution="640 480"
      pos="-0.661 0.324 1.325"
      xyaxes="0.026 -1.000 0.000 0.062 0.002 0.998"
    />

    <!-- Cylindrical pedestal: radius=0.2, length=0.9 (size takes half-length=0.45) -->
    <body name="pedestal" pos="0 0 0">
      <!-- place geom so the cylinder stands from z=0 to z=0.9 -->
      <geom
        name="pedestal_geom"
        type="cylinder"
        size="0.2 0.45"
        pos="0 0 0.45"
        rgba="0.7 0.7 0.7 1"
      />
      <!-- useful marker at the top of the pedestal -->
      <site
        name="pedestal_top"
        pos="0 0 0.9"
        size="0.01"
        type="sphere"
        rgba="0.1 0.8 0.1 1"
      />
    </body>

    <body name="desk" pos="0.8 0.1 0" euler="0 0 -1.5708">
      <body name="counters1" pos="0 0 0">
        <include file="assets/kitchen_assets/item_assets/counters_chain.xml" />
      </body>
      <body name="oven" pos="0 0 0">
        <include file="assets/kitchen_assets/item_assets/oven_chain.xml" />
      </body>
      <body name="backwall" pos="0 0 0">
        <include file="assets/kitchen_assets/item_assets/backwall_chain.xml" />
      </body>
      <body name="slidecabinet" pos="0.24 0.18 1.56">
        <include
          file="assets/kitchen_assets/item_assets/slidecabinet_chain.xml"
        />
      </body>
      <body name="hingecabinet" pos="-0.3024 0.168 1.56">
        <include
          file="assets/kitchen_assets/item_assets/hingecabinet_chain.xml"
        />
      </body>
      <body name="microwave" pos="-0.45 -0.015 0.96" euler="0 0 0.3">
        <include file="assets/kitchen_assets/item_assets/microwave_chain.xml" />
      </body>
    </body>

    <body name="kettle" pos="0.2 0.6 0.96" euler="0 0 -3.14">
      <freejoint name="kettle" />
      <include file="assets/kitchen_assets/item_assets/kettle_chain.xml" />
    </body>
  </worldbody>

  <keyframe>
    <!-- Home position for FR3 robot with gripper
       qpos: 
         fr3_joint1,
         fr3_joint2,
         fr3_joint3,
         fr3_joint4,
         fr3_joint5,
         fr3_joint6,
         fr3_joint7,
         fr3_finger1,
         fr3_finger2
         ...
       ctrl: 
         fr3_joint1,
         fr3_joint2,
         fr3_joint3,
         fr3_joint4,
         fr3_joint5,
         fr3_joint6,
         fr3_joint7,
         fr3_finger1 - We control only one finger.
    -->
    <key
      name="home"
      qpos="0 -0.7854 0 -2.3562 0 1.5707 0.7853 0.035 0.035 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0.6 0.96 0 0 0 0"
      ctrl="0 -0.7854 0 -2.3562 0 1.5707 0.7853 0.035"
    />
  </keyframe>
</mujoco>
