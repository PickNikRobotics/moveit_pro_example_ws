<?xml version="1.0" encoding="UTF-8" ?>
<root BTCPP_format="4" main_tree_to_execute="Parallel Sort">
  <BehaviorTree ID="Parallel Sort" _description="pleak" _favorite="false">
    <Control ID="Sequence">
      <Action ID="StopwatchBegin" timepoint="{timepoint}" />
      <Control ID="Parallel" success_count="1" failure_count="1">
        <Control ID="Sequence">
          <SubTree
            ID="Find Red Block"
            _collapsed="true"
            object_centroid="{object_centroid}"
          />
          <Action ID="Script" code="found:='red'" />
        </Control>
        <Control ID="Sequence">
          <SubTree
            ID="Find Green Block"
            _collapsed="true"
            object_centroid="{object_centroid}"
          />
          <Action ID="Script" code="found:='green'" />
        </Control>
      </Control>
      <Control ID="Sequence">
        <SubTree ID="Open Right Gripper" _collapsed="true" />
        <Action
          ID="InitializeMTCTask"
          task="{mtc_task}"
          timeout="-1.000000"
          trajectory_monitoring="false"
          controller_names="joint_trajectory_controller"
          task_id="right_grasp_task"
        />
        <Action ID="SetupMTCCurrentState" task="{mtc_task}" />
        <Action
          ID="SetupMTCPlanToPose"
          acceleration_scale_factor="1.000000"
          ik_frame="right_fr3_hand_tcp"
          keep_orientation="false"
          keep_orientation_link_names="right_fr3_hand_tcp"
          keep_orientation_tolerance="0.100000"
          link_padding="0.000000"
          max_iterations="5000"
          monitored_stage="current state"
          planning_group_name="right_manipulator"
          target_pose="{object_centroid}"
          task="{mtc_task}"
          trajectory_sampling_rate="100"
          velocity_scale_factor="1.000000"
        />
        <Action ID="PlanMTCTask" solution="{mtc_solution}" task="{mtc_task}" />
        <Action
          ID="ExecuteMTCTask"
          goal_duration_tolerance="-1.000000"
          solution="{mtc_solution}"
        />
        <SubTree ID="Close Right Gripper" _collapsed="true" />
        <Action
          ID="InitializeMTCTask"
          task="{mtc_task}"
          timeout="-1.000000"
          trajectory_monitoring="false"
          controller_names="joint_trajectory_controller"
          task_id="right_place_task"
        />
        <Action ID="SetupMTCCurrentState" task="{mtc_task}" />
        <Action
          ID="RetrieveWaypoint"
          joint_group_name="right_manipulator"
          waypoint_joint_state="{target_joint_state}"
          waypoint_name="Place Right"
        />
        <Action
          ID="SetupMTCPlanToJointState"
          acceleration_scale_factor="1.000000"
          joint_state="{target_joint_state}"
          keep_orientation="false"
          keep_orientation_link_names="grasp_link"
          keep_orientation_tolerance="0.100000"
          link_padding="0.000000"
          max_iterations="5000"
          planning_group_name="manipulator"
          seed="0"
          task="{mtc_task}"
          trajectory_sampling_rate="100"
          velocity_scale_factor="1.000000"
        />
        <Action ID="PlanMTCTask" solution="{mtc_solution}" task="{mtc_task}" />
        <Action
          ID="ExecuteMTCTask"
          goal_duration_tolerance="-1.000000"
          solution="{mtc_solution}"
        />
        <SubTree ID="Open Right Gripper" _collapsed="true" />
        <SubTree
          ID="Move to Waypoint"
          _collapsed="true"
          acceleration_scale_factor="1.0"
          controller_action_server="/joint_trajectory_controller/follow_joint_trajectory"
          controller_names="joint_trajectory_controller"
          joint_group_name="manipulator"
          keep_orientation="false"
          keep_orientation_tolerance="0.05"
          link_padding="0.01"
          seed="0"
          velocity_scale_factor="1.0"
          waypoint_name="Home"
        />
      </Control>
      <Control ID="Fallback">
        <Decorator
          ID="Precondition"
          else="FAILURE"
          if="found == &quot;red&quot;"
        >
          <SubTree
            ID="Find Green Block"
            _collapsed="true"
            object_centroid="{object_centroid}"
          />
        </Decorator>
        <SubTree
          ID="Find Red Block"
          _collapsed="true"
          object_centroid="{object_centroid}"
        />
      </Control>
      <Control ID="Sequence">
        <SubTree ID="Open Left Gripper" _collapsed="true" />
        <Action
          ID="InitializeMTCTask"
          task="{mtc_task}"
          timeout="-1.000000"
          trajectory_monitoring="false"
          controller_names="joint_trajectory_controller"
          task_id="left_grasp_task"
        />
        <Action ID="SetupMTCCurrentState" task="{mtc_task}" />
        <Action
          ID="SetupMTCMoveAlongFrameAxis"
          acceleration_scale="1.000000"
          axis_frame="world"
          axis_x="0.000000"
          axis_y="0.000000"
          axis_z="1.000000"
          hand_frame="left_fr3_hand_tcp"
          ignore_environment_collisions="false"
          max_distance="0.1"
          min_distance="0.100000"
          planning_group_name="left_manipulator"
          task="{mtc_task}"
          velocity_scale="1.000000"
        />
        <Action
          ID="SetupMTCPlanToPose"
          acceleration_scale_factor="1.000000"
          ik_frame="left_fr3_hand_tcp"
          keep_orientation="false"
          keep_orientation_link_names="left_fr3_hand_tcp"
          keep_orientation_tolerance="0.100000"
          link_padding="0.000000"
          max_iterations="5000"
          monitored_stage="current state"
          planning_group_name="left_manipulator"
          target_pose="{object_centroid}"
          task="{mtc_task}"
          trajectory_sampling_rate="100"
          velocity_scale_factor="1.000000"
        />
        <Action ID="PlanMTCTask" solution="{mtc_solution}" task="{mtc_task}" />
        <Action
          ID="ExecuteMTCTask"
          goal_duration_tolerance="-1.000000"
          solution="{mtc_solution}"
        />
        <SubTree ID="Close Left Gripper" _collapsed="true" />
        <Action
          ID="InitializeMTCTask"
          task="{mtc_task}"
          timeout="-1.000000"
          trajectory_monitoring="false"
          controller_names="joint_trajectory_controller"
          task_id="left_place_task"
        />
        <Action ID="SetupMTCCurrentState" task="{mtc_task}" />
        <Action
          ID="RetrieveWaypoint"
          joint_group_name="left_manipulator"
          waypoint_joint_state="{target_joint_state}"
          waypoint_name="Place Left"
        />
        <Action
          ID="SetupMTCPlanToJointState"
          acceleration_scale_factor="1.000000"
          joint_state="{target_joint_state}"
          keep_orientation="false"
          keep_orientation_link_names="grasp_link"
          keep_orientation_tolerance="0.100000"
          link_padding="0.000000"
          max_iterations="5000"
          planning_group_name="manipulator"
          seed="0"
          task="{mtc_task}"
          trajectory_sampling_rate="100"
          velocity_scale_factor="1.000000"
        />
        <Action ID="PlanMTCTask" solution="{mtc_solution}" task="{mtc_task}" />
        <Action
          ID="ExecuteMTCTask"
          goal_duration_tolerance="-1.000000"
          solution="{mtc_solution}"
        />
        <SubTree ID="Open Left Gripper" _collapsed="true" />
        <SubTree
          ID="Move to Waypoint"
          _collapsed="true"
          acceleration_scale_factor="1.0"
          controller_action_server="/joint_trajectory_controller/follow_joint_trajectory"
          controller_names="joint_trajectory_controller"
          joint_group_name="manipulator"
          keep_orientation="false"
          keep_orientation_tolerance="0.05"
          link_padding="0.01"
          seed="0"
          velocity_scale_factor="1.0"
          waypoint_name="Home"
        />
      </Control>
      <Action ID="StopwatchEnd" timepoint="{timepoint}" />
    </Control>
  </BehaviorTree>
  <TreeNodesModel>
    <SubTree ID="Parallel Sort">
      <MetadataFields>
        <Metadata subcategory="Motion - Execute" />
        <Metadata runnable="true" />
      </MetadataFields>
    </SubTree>
  </TreeNodesModel>
</root>
